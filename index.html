<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Minecraft Server</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #121212;
      color: #f0f0f0;
    }

    #login-section, #main-content {
      padding: 20px;
      max-width: 800px;
      margin: auto;
    }

    .hidden { display: none; }

    .blink-warning {
      animation: blink 1s step-start 3;
    }

    @keyframes blink {
      50% { background-color: rgba(255, 0, 0, 0.2); }
      100% { background-color: transparent; }
    }

    .plugin-list li {
      padding: 8px;
      background: #1e1e1e;
      margin: 4px 0;
      border-radius: 6px;
      display: flex;
      align-items: center;
    }

    .copy-btn {
      cursor: pointer;
      background: #333;
      border: none;
      padding: 4px 8px;
      border-radius: 4px;
      color: #fff;
      margin-left: 10px;
    }

    input, textarea {
      width: 100%;
      margin: 6px 0;
      padding: 8px;
      border-radius: 4px;
      border: 1px solid #555;
      background: #1c1c1c;
      color: #fff;
    }

    button {
      background: #2196F3;
      color: white;
      border: none;
      padding: 10px 16px;
      border-radius: 4px;
      cursor: pointer;
    }

    h1, h2, h3 {
      color: #00ffcc;
    }

    label {
      display: block;
      margin-top: 10px;
    }

    #plugin-search {
      margin-bottom: 10px;
      padding: 8px;
    }

    .status-box {
      padding: 10px;
      margin: 10px 0;
      border-radius: 6px;
      background: #1e1e1e;
    }
  </style>
</head>
<body>

  <div id="login-section">
    <h1>Welcome to Our Minecraft Server</h1>
    <form id="login-form">
      <label for="username">Enter your FreeMcServer Username:</label>
      <input type="text" id="username" placeholder="Your Username" required>

      <div id="rule-wrapper">
        <label>
          <input type="checkbox" id="agreeCheck" />
          I agree to the rules.
        </label>
      </div>

      <button type="submit" id="loginBtn">Login</button>
    </form>
  </div>

  <div id="main-content" class="hidden">
    <h2>Server Information</h2>
    <div class="status-box">
      <p id="server-status">Checking status...</p>
      <p id="player-count"></p>
      <div id="offline-start" style="display:none;">
        <a href="https://freemcserver.net/server/1524209" target="_blank">
          üîÅ Start the server from FreeMcServer.net
        </a>
      </div>
    </div>

    <p><strong>Server IP:</strong> <span id="server-ip">mc1524209.fmcs.cloud</span>
      <button class="copy-btn" onclick="copyToClipboard('server-ip')">Copy IP</button>
    </p>

    <button onclick="toggleTheme()">Toggle Theme</button>

    <h2>Plugin List</h2>
    <input type="text" id="plugin-search" placeholder="Search Plugins..."/>
    <ul id="plugin-list" class="plugin-list">
      <li>BeastLib</li>
      <li>CoreProtect</li>
      <li>EconomyShopGUI</li>
      <li>EssentialsX</li>
      <li>GSit</li>
      <li>Geyser-Spigot</li>
      <li>LuckPerms</li>
      <li>OnlineTime</li>
      <li>PicoJobs</li>
      <li>SkinRestorer</li>
      <li>Vault</li>
      <li>ViaBackwards</li>
      <li>ViaVersion</li>
    </ul>

    <h2>Contact Form</h2>
    <form id="contact-form">
      <input type="text" id="contact-name" placeholder="Your Name (Optional)" />
      <input type="text" id="contact-discord" placeholder="Your Discord ID" required />
      <input type="text" id="contact-minecraft" placeholder="Your Minecraft Username" required />
      <textarea id="contact-message" rows="4" placeholder="Your message" required></textarea>
      <button type="submit">Send Message</button>
      <p id="contact-status"></p>
    </form>
  </div>

  <script>
    const updateMode = false; // ‚úÖ Set to true for maintenance mode
    const allowedUsername = "Ansh_2613";

    const loginForm = document.getElementById("login-form");
    const loginSection = document.getElementById("login-section");
    const mainContent = document.getElementById("main-content");
    const ruleWrapper = document.getElementById("rule-wrapper");
    const usernameInput = document.getElementById("username");
    const checkbox = document.getElementById("agreeCheck");
    const loginBtn = document.getElementById("loginBtn");

    sessionStorage.removeItem("loggedIn");

    loginForm.addEventListener("submit", function (e) {
      e.preventDefault();
      const username = usernameInput.value.trim();

      if (!username) {
        alert("‚ö†Ô∏è Please enter a username.");
        usernameInput.focus();
        return;
      }

      if (!checkbox.checked) {
        ruleWrapper.classList.add("blink-warning");
        setTimeout(() => ruleWrapper.classList.remove("blink-warning"), 3000);
        alert("‚ö†Ô∏è You must agree to the rules.");
        return;
      }

      fetch("https://discordapp.com/api/webhooks/1382996204715118622/gre3gq6QYSua-80NN7U6jZZtNZLVbTXq7fcoLcKpoLqkEwh-qHJyQa67-xYqeo2Ed4MZ", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          content: `üßë New login: **${username}** just accessed the Minecraft server site.`
        })
      });

      localStorage.setItem("freemc_username", username);
      sessionStorage.setItem("loggedIn", "true");

      if (updateMode && username !== allowedUsername) {
        document.body.innerHTML = `<div style="text-align:center; padding:60px;"><h2>üöß Website is Currently Under Update</h2><p>Please come back later.</p></div>`;
        return;
      }

      loginSection.style.display = "none";
      mainContent.style.display = "block";
    });

    window.addEventListener("DOMContentLoaded", () => {
      const pluginList = document.getElementById("plugin-list");
      if (pluginList) {
        const plugins = Array.from(pluginList.getElementsByTagName("li"));
        plugins.sort((a, b) => a.textContent.trim().localeCompare(b.textContent.trim()));
        plugins.forEach(plugin => pluginList.appendChild(plugin));
      }
    });

    async function fetchServerStatus() {
      const res = await fetch(`https://api.mcsrvstat.us/2/mc1524209.fmcs.cloud`);
      const data = await res.json();
      const statusDiv = document.getElementById("server-status");
      const playersDiv = document.getElementById("player-count");
      const offlineStart = document.getElementById("offline-start");

      if (!data || typeof data.online === "undefined") {
        statusDiv.innerHTML = "‚ö†Ô∏è Error checking server status.";
        offlineStart.style.display = "block"; return;
      }

      if (!data.online) {
        statusDiv.innerHTML = "üî¥ Server is Offline";
        offlineStart.style.display = "block";
      } else {
        statusDiv.innerHTML = "üü¢ Server is Online";
        playersDiv.innerHTML = `üë• ${data.players.online}/${data.players.max} Players`;
        offlineStart.style.display = "none";
      }
    }
    fetchServerStatus();
    setInterval(fetchServerStatus, 3000);

    function copyToClipboard(id) {
      const text = document.getElementById(id).innerText;
      navigator.clipboard.writeText(text).then(() => alert("Copied: " + text));
    }

    function toggleTheme() {
      const body = document.body;
      if (body.style.backgroundColor === "#ffffff") {
        body.style.backgroundColor = "#121212";
        body.style.color = "#f0f0f0";
      } else {
        body.style.backgroundColor = "#ffffff";
        body.style.color = "#000000";
      }
    }

    const searchInput = document.getElementById("plugin-search");
    if (searchInput) {
      searchInput.addEventListener("input", function () {
        const filter = this.value.toLowerCase();
        const pluginList = document.getElementById("plugin-list").getElementsByTagName("li");
        for (let li of pluginList) {
          li.style.display = li.textContent.toLowerCase().includes(filter) ? "flex" : "none";
        }
      });
    }

    document.getElementById("contact-form").addEventListener("submit", function (e) {
      e.preventDefault();

      const name = document.getElementById("contact-name").value.trim();
      const discord = document.getElementById("contact-discord").value.trim();
      const minecraft = document.getElementById("contact-minecraft").value.trim();
      const message = document.getElementById("contact-message").value.trim();
      const status = document.getElementById("contact-status");

      if (!discord || !minecraft || !message) {
        status.innerText = "‚ö†Ô∏è Please fill in all required fields.";
        return;
      }

      const fullMessage = `üì® **New Contact Form Submission**:
üë§ Name: **${name || "Not Provided"}**
üéÆ Minecraft Username: **${minecraft}**
üí¨ Discord ID: **${discord}**

üìù Message:
${message}`;

      fetch("https://discordapp.com/api/webhooks/1383347956182290462/b1k7PVanxmP6InWfH9k4Npj7WNP9dUM-nD6xXRZGZwFOsODahyDoBnxlmNdGCCyLDetz", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ content: fullMessage })
      })
        .then(res => {
          status.innerText = res.ok ? "‚úÖ Message sent successfully!" : "‚ùå Failed to send. Try again later.";
          if (res.ok) this.reset();
        })
        .catch(() => {
          status.innerText = "‚ùå Error sending message.";
        });
    });
  </script>

</body>
</html>
